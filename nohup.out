Config file config.yml is extended by additional config specified via the command line.
/home/MCB/jkoszucki/.conda/envs/snakemake/lib/python3.10/site-packages/Bio/GenBank/__init__.py:751: BiopythonParserWarning: Non-upper case molecule type in LOCUS line: dna
  warnings.warn(
Building DAG of jobs...
Your conda installation is not configured to use strict channel priorities. This is however crucial for having robust and correct environments (for details, see https://conda-forge.org/docs/user/tipsandtricks.html). Please consider to configure strict priorities by executing 'conda config --set channel_priority strict'.
Creating conda environment envs/base.yml...
Downloading and installing remote packages.
Environment for /home/MCB/jkoszucki/Code/mgg_prophages/envs/base.yml created (location: .snakemake/conda/aca0406753d5b5161de35d590010801d_)
Creating conda environment envs/checkv.yml...
Downloading and installing remote packages.
Environment for /home/MCB/jkoszucki/Code/mgg_prophages/envs/checkv.yml created (location: .snakemake/conda/099659932b9e0653a1c66c89a6d20b13_)
Creating conda environment envs/phispy.yml...
Downloading and installing remote packages.
Environment for /home/MCB/jkoszucki/Code/mgg_prophages/envs/phispy.yml created (location: .snakemake/conda/cb9c2a928ba4b18d8d3affd1a4b3172d_)
Creating conda environment envs/virsorter.yml...
Downloading and installing remote packages.
Environment for /home/MCB/jkoszucki/Code/mgg_prophages/envs/virsorter.yml created (location: .snakemake/conda/eec76b4bc22dc327b0dc838b9ecdd7ff_)
Using shell: /bin/bash
Provided cores: 16
Rules claiming more threads will be scaled down.
Job stats:
job          count    min threads    max threads
---------  -------  -------------  -------------
checkv           1             16             16
phispy           1             16             16
primary          1              1              1
process          1              1              1
target           1              1              1
virsorter        1             16             16
total            6              1             16

Select jobs to execute...

[Mon Oct 17 15:27:47 2022]
rule phispy:
    input: /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/0_input/bacteria.gb, /home/MCB/jkoszucki/phagedb/MGG_DATABASE_SETUP/pVOGs.hmm
    output: /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/phispy.tsv
    jobid: 1
    reason: Missing output files: /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/phispy.tsv
    threads: 16
    resources: tmpdir=/tmp

Activating conda environment: .snakemake/conda/cb9c2a928ba4b18d8d3affd1a4b3172d_
/home/MCB/jkoszucki/Code/mgg_prophages/.snakemake/conda/cb9c2a928ba4b18d8d3affd1a4b3172d_/lib/python3.9/site-packages/Bio/GenBank/__init__.py:751: BiopythonParserWarning: Non-upper case molecule type in LOCUS line: dna
  warnings.warn(
Processing 120 contigs
Running HMM profiles against /home/MCB/jkoszucki/phagedb/MGG_DATABASE_SETUP/pVOGs.hmm
hmmsearch: writing the amino acids to temporary file /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/phispy/tmpsbw34l1c
Searching 26527 proteins with hmmsearch.
Completed running HMM profiles against /home/MCB/jkoszucki/phagedb/MGG_DATABASE_SETUP/pVOGs.hmm
Making Testing Set...
Start Classification Algorithm...
Using all metrics: orf_length_med, shannon_slope, at_skew, gc_skew, max_direction, phmms.
Running the random forest classifier with 500 trees and 16 threads
As the training flag is zero, down-weighting unknown functions
Evaluating...
Checking prophages we might have found
Potential prophages (sorted highest to lowest)
Contig	Start	Stop	Number of potential genes	Status
AOVQZBSH.2	685612	726529	52	Kept
AJZSYRCA.1	331746	372524	50	Kept
AOVQZBSH.2	407462	452193	48	Kept
ARNUETAI.1	3154772	3208365	47	Kept
AOVQZBSH.3	161764	201968	47	Kept
AZOEDSNF.14	37608	71277	37	Kept
ARNUETAI.1	1812875	1839920	37	Kept
ALBVAVCN.19	4092	41257	35	Kept
ALBVAVCN.8	43634	80444	32	Kept
AZOEDSNF.12	1	23546	29	Kept
AZOEDSNF.26	22835	36562	17	Kept
AZOEDSNF.40	3	11542	13	Kept
ARNUETAI.1	3663879	3677353	11	Kept
AZOEDSNF.4	2	10380	8	Kept
AZOEDSNF.34	1	12430	8	Kept
AZOEDSNF.2	460978	469979	5	Kept
ARNUETAI.1	1226318	1233561	5	Kept
AZOEDSNF.9	156962	167407	3	Dropped. Not enough genes
AZOEDSNF.26	16245	18281	3	Dropped. Not enough genes
AZOEDSNF.1	335010	349801	3	Dropped. Not enough genes
ALBVAVCN.9	32404	38079	3	Dropped. Not enough genes
ALBVAVCN.7	215236	216308	3	Dropped. Not enough genes
AJZSYRCA.4	448376	452572	3	Dropped. Not enough genes
AZOEDSNF.41	7683	8449	2	Dropped. Not enough genes
AZOEDSNF.2	36263	38097	2	Dropped. Not enough genes
ARNUETAI.1	3808357	3810191	2	Dropped. Not enough genes
ARNUETAI.1	3305026	3312715	2	Dropped. Not enough genes
ARNUETAI.1	775333	776868	2	Dropped. Not enough genes
AOVQZBSH.5	394246	399977	2	Dropped. Not enough genes
AOVQZBSH.1	498456	500290	2	Dropped. Not enough genes
ALBVAVCN.30	5280	10960	2	Dropped. Not enough genes
ALBVAVCN.3	513019	514853	2	Dropped. Not enough genes
ALBVAVCN.29	7339	12597	2	Dropped. Not enough genes
AJZSYRCA.3	525388	527222	2	Dropped. Not enough genes
AZOEDSNF.7	150660	151877	1	Dropped. Not enough genes
AZOEDSNF.7	37476	37868	1	Dropped. Not enough genes
AZOEDSNF.5	216923	217387	1	Dropped. Not enough genes
AZOEDSNF.4	15019	16200	1	Dropped. Not enough genes
AZOEDSNF.24	31611	32507	1	Dropped. Not enough genes
AZOEDSNF.21	37147	38049	1	Dropped. Not enough genes
AZOEDSNF.2	162946	164157	1	Dropped. Not enough genes
AZOEDSNF.2	3149	3451	1	Dropped. Not enough genes
AZOEDSNF.18	94354	94602	1	Dropped. Not enough genes
AZOEDSNF.16	20	259	1	Dropped. Not enough genes
AZOEDSNF.11	54648	55046	1	Dropped. Not enough genes
AZOEDSNF.10	124195	125484	1	Dropped. Not enough genes
AZOEDSNF.10	73618	74025	1	Dropped. Not enough genes
AZOEDSNF.10	31195	32151	1	Dropped. Not enough genes
AZOEDSNF.1	750909	752957	1	Dropped. Not enough genes
AZOEDSNF.1	700545	701456	1	Dropped. Not enough genes
AZOEDSNF.1	653064	654488	1	Dropped. Not enough genes
AZOEDSNF.1	90010	90579	1	Dropped. Not enough genes
AZOEDSNF.1	80434	81690	1	Dropped. Not enough genes
ARNUETAI.1	5140643	5141545	1	Dropped. Not enough genes
ARNUETAI.1	5021375	5022664	1	Dropped. Not enough genes
ARNUETAI.1	4972829	4973236	1	Dropped. Not enough genes
ARNUETAI.1	4930540	4931496	1	Dropped. Not enough genes
ARNUETAI.1	4729460	4730707	1	Dropped. Not enough genes
ARNUETAI.1	4263622	4264086	1	Dropped. Not enough genes
ARNUETAI.1	4240149	4241330	1	Dropped. Not enough genes
ARNUETAI.1	3948749	3949111	1	Dropped. Not enough genes
ARNUETAI.1	3844372	3844674	1	Dropped. Not enough genes
ARNUETAI.1	3687242	3689056	1	Dropped. Not enough genes
ARNUETAI.1	3651031	3652242	1	Dropped. Not enough genes
ARNUETAI.1	3348856	3350175	1	Dropped. Not enough genes
ARNUETAI.1	2843752	2844144	1	Dropped. Not enough genes
ARNUETAI.1	2741887	2743104	1	Dropped. Not enough genes
ARNUETAI.1	1936664	1938712	1	Dropped. Not enough genes
ARNUETAI.1	863761	864657	1	Dropped. Not enough genes
ARNUETAI.1	605109	605507	1	Dropped. Not enough genes
AOVQZBSH.8	139818	140216	1	Dropped. Not enough genes
AOVQZBSH.6	331392	332681	1	Dropped. Not enough genes
AOVQZBSH.6	282840	283247	1	Dropped. Not enough genes
AOVQZBSH.6	242282	243238	1	Dropped. Not enough genes
AOVQZBSH.5	31273	32169	1	Dropped. Not enough genes
AOVQZBSH.3	475242	476459	1	Dropped. Not enough genes
AOVQZBSH.3	376406	376798	1	Dropped. Not enough genes
AOVQZBSH.2	86368	88416	1	Dropped. Not enough genes
AOVQZBSH.13	36997	37899	1	Dropped. Not enough genes
AOVQZBSH.11	59286	59843	1	Dropped. Not enough genes
AOVQZBSH.1	911524	912057	1	Dropped. Not enough genes
AOVQZBSH.1	642595	642957	1	Dropped. Not enough genes
AOVQZBSH.1	533020	533322	1	Dropped. Not enough genes
AOVQZBSH.1	374933	376144	1	Dropped. Not enough genes
ALBVAVCN.6	139705	140103	1	Dropped. Not enough genes
ALBVAVCN.4	426198	427094	1	Dropped. Not enough genes
ALBVAVCN.3	659119	659481	1	Dropped. Not enough genes
ALBVAVCN.3	547582	547884	1	Dropped. Not enough genes
ALBVAVCN.3	380552	381763	1	Dropped. Not enough genes
ALBVAVCN.27	18304	18900	1	Dropped. Not enough genes
ALBVAVCN.2	240213	241271	1	Dropped. Not enough genes
ALBVAVCN.2	86345	88393	1	Dropped. Not enough genes
ALBVAVCN.16	37009	37911	1	Dropped. Not enough genes
ALBVAVCN.11	121453	122409	1	Dropped. Not enough genes
ALBVAVCN.11	80040	80447	1	Dropped. Not enough genes
ALBVAVCN.11	30604	31893	1	Dropped. Not enough genes
ALBVAVCN.1	809691	810083	1	Dropped. Not enough genes
ALBVAVCN.1	707355	708455	1	Dropped. Not enough genes
AJZSYRCA.8	150386	150784	1	Dropped. Not enough genes
AJZSYRCA.7	128077	129033	1	Dropped. Not enough genes
AJZSYRCA.7	85852	86259	1	Dropped. Not enough genes
AJZSYRCA.7	34377	35666	1	Dropped. Not enough genes
AJZSYRCA.4	31361	32257	1	Dropped. Not enough genes
AJZSYRCA.3	398858	400069	1	Dropped. Not enough genes
AJZSYRCA.2	416879	418162	1	Dropped. Not enough genes
AJZSYRCA.13	48297	49199	1	Dropped. Not enough genes
AJZSYRCA.1	1449045	1449209	1	Dropped. Not enough genes
AJZSYRCA.1	1085064	1085456	1	Dropped. Not enough genes
AJZSYRCA.1	970970	972187	1	Dropped. Not enough genes
AJZSYRCA.1	389473	390645	1	Dropped. Not enough genes
AJZSYRCA.1	91069	93117	1	Dropped. Not enough genes
PROPHAGE: 1 Contig: AJZSYRCA.1 Start: 331746 Stop: 372524
PROPHAGE: 2 Contig: ALBVAVCN.8 Start: 43634 Stop: 80444
PROPHAGE: 3 Contig: ALBVAVCN.19 Start: 4092 Stop: 41257
There were 4 repeats with the same length as the best. One chosen somewhat randomly!
PROPHAGE: 4 Contig: AOVQZBSH.2 Start: 407462 Stop: 452193
PROPHAGE: 5 Contig: AOVQZBSH.2 Start: 685612 Stop: 726529
PROPHAGE: 6 Contig: AOVQZBSH.3 Start: 161764 Stop: 201968
There were 6 repeats with the same length as the best. One chosen somewhat randomly!
PROPHAGE: 7 Contig: ARNUETAI.1 Start: 1226318 Stop: 1233561
PROPHAGE: 8 Contig: ARNUETAI.1 Start: 1812875 Stop: 1839920
There were 5 repeats with the same length as the best. One chosen somewhat randomly!
PROPHAGE: 9 Contig: ARNUETAI.1 Start: 3154772 Stop: 3208365
PROPHAGE: 10 Contig: ARNUETAI.1 Start: 3663879 Stop: 3677353
There were 3 repeats with the same length as the best. One chosen somewhat randomly!
PROPHAGE: 11 Contig: AZOEDSNF.2 Start: 460978 Stop: 469979
PROPHAGE: 12 Contig: AZOEDSNF.4 Start: 2 Stop: 10380
There were 4 repeats with the same length as the best. One chosen somewhat randomly!
PROPHAGE: 13 Contig: AZOEDSNF.12 Start: 1 Stop: 23546
PROPHAGE: 14 Contig: AZOEDSNF.14 Start: 37608 Stop: 71277
PROPHAGE: 15 Contig: AZOEDSNF.26 Start: 22835 Stop: 36562
There were 5 repeats with the same length as the best. One chosen somewhat randomly!
PROPHAGE: 16 Contig: AZOEDSNF.34 Start: 1 Stop: 12430
PROPHAGE: 17 Contig: AZOEDSNF.40 Start: 3 Stop: 11542
Creating output files
Writing GenBank output file
Writing prophage_coordinates output file
Done!!! Output is in /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/phispy and the log is in /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/phispy/phispy.log
[Mon Oct 17 15:38:05 2022]
Finished job 1.
1 of 6 steps (17%) done
Select jobs to execute...

[Mon Oct 17 15:38:05 2022]
rule virsorter:
    input: /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/0_input/bacteria.fasta, /home/MCB/jkoszucki/phagedb/MGG_DATABASE_SETUP/virsorter_tool/VirSorter/wrapper_phage_contigs_sorter_iPlant.pl, /home/MCB/jkoszucki/phagedb/MGG_DATABASE_SETUP/virsorter_tool/virsorterDB_v2
    output: /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter
    jobid: 2
    reason: Missing output files: /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter
    threads: 16
    resources: tmpdir=/tmp

Activating conda environment: .snakemake/conda/eec76b4bc22dc327b0dc838b9ecdd7ff_
Reading '/home/MCB/jkoszucki/.cpan/Metadata'
  Database was generated on Sun, 16 Oct 2022 16:41:02 GMT
Running install for module 'File::Which'
Running make for P/PL/PLICEASE/File-Which-1.27.tar.gz
Checksum for /home/MCB/jkoszucki/.cpan/sources/authors/id/P/PL/PLICEASE/File-Which-1.27.tar.gz ok

  CPAN.pm: Building P/PL/PLICEASE/File-Which-1.27.tar.gz

Checking if your kit is complete...
Looks good
Writing Makefile for File::Which
Writing MYMETA.yml and MYMETA.json
cp lib/File/Which.pm blib/lib/File/Which.pm
Manifying blib/man3/File::Which.3
  PLICEASE/File-Which-1.27.tar.gz
  make -- OK
'YAML' not installed, will not store persistent state
Running make test
PERL_DL_NONLAZY=1 /home/MCB/jkoszucki/Code/mgg_prophages/.snakemake/conda/eec76b4bc22dc327b0dc838b9ecdd7ff_/bin/perl "-MExtUtils::Command::MM" "-e" "test_harness(0, 'blib/lib', 'blib/arch')" t/*.t
# 
# 
# 
# HARNESS_ACTIVE=1
# HARNESS_VERSION=3.26
# LANG=en_US.UTF-8
# LC_TERMINAL=iTerm2
# LC_TERMINAL_VERSION=3.4.16
# PERL5LIB=/home/MCB/jkoszucki/.cpan/build/File-Which-1.27-OxZamG/blib/lib:/home/MCB/jkoszucki/.cpan/build/File-Which-1.27-OxZamG/blib/arch:
# PERL5OPT=
# PERL5_CPANPLUS_IS_RUNNING=3585790
# PERL5_CPAN_IS_RUNNING=3585790
# PERL_DL_NONLAZY=1
# SHELL=/bin/bash
# 
# 
# 
# PERL5LIB path
# /home/MCB/jkoszucki/.cpan/build/File-Which-1.27-OxZamG/blib/lib
# /home/MCB/jkoszucki/.cpan/build/File-Which-1.27-OxZamG/blib/arch
# 
# 
# 
# perl                5.018002 linux x86_64-linux
# Env                 1.04
# ExtUtils::MakeMaker 6.66
# Test::More          0.98
# 
# 
# 
t/00_diag.t ..... ok
t/01_use.t ...... ok
t/file_which.t .. ok
All tests successful.
Files=3, Tests=21,  0 wallclock secs ( 0.02 usr  0.00 sys +  0.08 cusr  0.03 csys =  0.13 CPU)
Result: PASS
  PLICEASE/File-Which-1.27.tar.gz
  make test -- OK
Running make install
Installing /home/MCB/jkoszucki/Code/mgg_prophages/.snakemake/conda/eec76b4bc22dc327b0dc838b9ecdd7ff_/lib/perl5/site_perl/5.18.2/File/Which.pm
Installing /home/MCB/jkoszucki/Code/mgg_prophages/.snakemake/conda/eec76b4bc22dc327b0dc838b9ecdd7ff_/man/man3/File::Which.3
Appending installation info to /home/MCB/jkoszucki/Code/mgg_prophages/.snakemake/conda/eec76b4bc22dc327b0dc838b9ecdd7ff_/lib/perl5/5.18.2/x86_64-linux/perllocal.pod
  PLICEASE/File-Which-1.27.tar.gz
  make install  -- OK
This VirSorter run uses `diamond` (Buchfink et al., Nature Methods 2015) instead of `blastp`.

Bin            : /home/MCB/jkoszucki/phagedb/MGG_DATABASE_SETUP/virsorter_tool/VirSorter
Dataset        : VIRSorter
Input file     : /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/0_input/bacteria.fasta
Db             : 1
Working dir    : /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter
Custom phages  : 
Data dir       : /home/MCB/jkoszucki/phagedb/MGG_DATABASE_SETUP/virsorter_tool/virsorterDB_v2
Num CPUs       : 16
blastp         : diamond

Started at Mon Oct 17 15:38:12 2022
Step 0.5 : perl /home/MCB/jkoszucki/phagedb/MGG_DATABASE_SETUP/virsorter_tool/VirSorter/Scripts/Step_1_contigs_cleaning_and_gene_prediction.pl VIRSorter /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/fasta /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/fasta/input_sequences.fna 2 >> /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/logs/out 2>> /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/logs/err
	
Started at Mon Oct 17 15:39:33 2022
Step 0.8 : /home/MCB/jkoszucki/Code/mgg_prophages/.snakemake/conda/eec76b4bc22dc327b0dc838b9ecdd7ff_/bin/hmmsearch --tblout /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/Contigs_prots_vs_PFAMa.tab --cpu 16 -o /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/Contigs_prots_vs_PFAMa.out --noali /home/MCB/jkoszucki/phagedb/MGG_DATABASE_SETUP/virsorter_tool/virsorterDB_v2/PFAM_27/Pfam-A.hmm /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/fasta/VIRSorter_prots.fasta >> /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/logs/out 2>> /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/logs/err
	
Started at Mon Oct 17 15:54:54 2022
Step 0.9 : /home/MCB/jkoszucki/Code/mgg_prophages/.snakemake/conda/eec76b4bc22dc327b0dc838b9ecdd7ff_/bin/hmmsearch --tblout /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/Contigs_prots_vs_PFAMb.tab --cpu 16 -o /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/Contigs_prots_vs_PFAMb.out --noali /home/MCB/jkoszucki/phagedb/MGG_DATABASE_SETUP/virsorter_tool/virsorterDB_v2/PFAM_27/Pfam-B.hmm /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/fasta/VIRSorter_prots.fasta >> /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/logs/out 2>> /home/MCB/jkoszucki/phagedb/PROPHAGES_2022-10-17/1_primary/raw/virsorter/logs/err
